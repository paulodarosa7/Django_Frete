{% extends 'base_inside.html' %}
{% load static %}

{% block title %}Status do Frete â€” FretesExpress{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/status_frete.css' %}">
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
<link rel="stylesheet" href="https://unpkg.com/leaflet-routing-machine@latest/dist/leaflet-routing-machine.css"/>

<style>
    /* Mapa com tamanho fixo para nÃ£o ficar preto */
    #map {
        width: 90%;
        height: 380px;
        border-radius: 15px;
        margin: 0 auto;
        margin-top: 10px;
    }
</style>
{% endblock %}

{% block content %}
<div class="container">

    <!-- Topo -->
    <header class="topo">
        <h1 class="logo">FretesExpress</h1>
    </header>

    <!-- Mapa -->
    <div id="map"></div>

    <!-- EndereÃ§os enviados para o script -->
    <script id="endereco-coleta" type="application/json">
        "{{ frete.endereco_coleta }}"
    </script>

    <script id="endereco-entrega" type="application/json">
        "{{ frete.endereco_entrega }}"
    </script>

    <!-- InformaÃ§Ãµes principais -->
    <div class="info">
        <p>ğŸ“¦ Produto â€” {{ frete.produto }}</p>
        <p>ğŸŸ¡ EndereÃ§o Origem â€” {{ frete.endereco_coleta }}</p>
        <p>âš« EndereÃ§o Destino â€” {{ frete.endereco_entrega }}</p>
        <span class="preco">R$ {{ frete.valor }}</span>
    </div>

    <!-- Status do frete -->
    <footer class="rodape">
        {% if frete.status == "pendente" %}
            <p>ğŸ’¬ Estamos procurando um entregador...</p>
        {% elif frete.status == "aceito" %}
            <p>ğŸšš Frete aceito por <strong>{{ frete.freteiro.nome }}</strong></p>
            <p class="sub">O entregador estÃ¡ a caminho da coleta!</p>
        {% elif frete.status == "em_andamento" %}
            <p>ğŸ“¦ O frete estÃ¡ em andamento!</p>
            <p class="sub">O entregador estÃ¡ levando o pedido atÃ© o destino.</p>
        {% elif frete.status == "concluido" %}
            <p>âœ… Frete concluÃ­do!</p>
            <p class="sub">Obrigado por usar o FretesExpress!</p>
        {% else %}
            <p>â„¹ Status desconhecido</p>
        {% endif %}
    </footer>

</div>
{% endblock %}

{% block extra_js %}
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script src="https://unpkg.com/leaflet-routing-machine@latest/dist/leaflet-routing-machine.js"></script>

<script src="https://api.mapbox.com/mapbox-gl-js/v2.17.0/mapbox-gl.js"></script>

<script src="{% static 'js/status_frete.js' %}"></script>
{% endblock %}
